<h1 class="text-3xl font-bold mb-4">Data Catalog</h1>
<form class="mb-6 grid md:grid-cols-5 gap-3">
  <input type="text" name="q" value="<%= h @q %>" placeholder="Search name or tags" class="border rounded px-3 py-2 md:col-span-2" />
  <input type="text" name="state" value="<%= h params[:state] %>" placeholder="State" class="border rounded px-3 py-2" />
  <input type="text" name="city" value="<%= h params[:city] %>" placeholder="City" class="border rounded px-3 py-2" />
  <input type="text" name="industry" value="<%= h params[:industry] %>" placeholder="Industry" class="border rounded px-3 py-2" />
  <select name="freshness" class="border rounded px-3 py-2">
    <option value="">Freshness</option>
    <option value="lt30" <%= 'selected' if params[:freshness] == 'lt30' %>>< 30 days</option>
    <option value="lt90" <%= 'selected' if params[:freshness] == 'lt90' %>>< 90 days</option>
  </select>
  <button class="btn-brand md:col-span-5">Filter</button>
  <a href="/catalog" class="text-sm link-brand">Reset</a>
  </form>

<div class="grid md:grid-cols-3 gap-6">
  <% @datasets.each do |d| %>
    <div class="bg-white border rounded p-4 flex flex-col">
      <div class="flex items-start justify-between gap-3">
        <div>
          <h3 class="font-semibold"><%= d["name"] %></h3>
          <div class="text-sm text-gray-600"><%= d["description"] %></div>
        </div>
        <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">~<%= d["freshnessDaysMedian"] %>d</span>
      </div>
      <div class="mt-2 text-xs text-gray-600">
        <%= d.dig("geography", "state") %> · <%= d.dig("geography", "city") %> · <%= d["industries"].join(", ") %>
      </div>
      <div class="mt-2 text-xs text-gray-600">Records: <%= d["recordCount"] %></div>
      <a href="<%= dataset_path(d["slug"]) %>" class="mt-3 inline-block text-blue-600">View Dataset →</a>
    </div>
  <% end %>
</div>
